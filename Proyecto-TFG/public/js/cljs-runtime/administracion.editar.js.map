{"version":3,"sources":["administracion/editar.cljs"],"mappings":"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","names":["administracion.editar/usuario-id","js/localStorage","administracion.editar/producto","reagent.core.atom","administracion.editar/categoria","administracion.editar/campo-seleccionado","administracion.editar/nuevo-valor","administracion.editar/estado-actualizacion","administracion.editar/get-producto-por-id","id","p1__18154#","cljs.core/deref","cljs.core/some","cljs.core._EQ_","app.db/list-productos","administracion.editar/obtener-id-categoria","nombre","categorias","cljs.core/first","p1__18155#","cljs.core.filter","administracion.editar/get-categoria-por-id","p1__18156#","app.db/categorias","administracion.editar/actualizar-producto","producto","campo","valor","usuario-id","js/localStorage.getItem","valor-parseado","G__18157","js/parseFloat","body-extendido","cljs.core/clj->js","cljs.core.assoc","url","opciones","js/JSON.stringify","js/fetch","respuesta","cljs.core/reset!","categoria","cljs.core.swap_BANG_","cljs.core/assoc","cljs.core.keyword","e","administracion.editar/actualizar-categoria","body","p1__18158#","administracion.editar/render-edicion-producto","or__5002__auto__","cljs.core.not_EQ_","p1__18159#","p1__18160#","p1__18161#","p1__18162#","p1__18163#","G__18165","fexpr__18164","iter__5480__auto__","s__18167","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__18169","cljs.core/chunk-buffer","i__18168","map__18170","cljs.core/-nth","cljs.core/--destructure-map","cljs.core.get","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__18166","cljs.core/chunk-rest","map__18171","cljs.core/cons","cljs.core/rest","p1__18172#","administracion.editar/render-edicion-categoria","p1__18173#","administracion.editar/page","params","cljs.core.get_in","app.state/current-route","tipo","js/parseInt","with-let18174","reagent.ratom/with-let-values","temp__5808__auto__","reagent.ratom/*ratom-context*","c__12240__auto__","reagent.debug/has-console","reagent.debug/tracking","reagent.debug/track-console","js/console","init18175","cljs.core/not","res18176","_","with-let18177","init18178","res18179","G__18180","js/Error","js/location","cljs.core/chunk-first"],"sourcesContent":["(ns administracion.editar\r\n  (:require [reagent.core :as r]\r\n            [reagent.dom :as dom]\r\n            [app.state :refer [current-route]]\r\n            [app.db :refer [list-productos categorias]]))\r\n\r\n(def usuario-id (.getItem js/localStorage \"id\"))\r\n(def producto (r/atom {}))\r\n(def categoria (r/atom {}))\r\n(def campo-seleccionado (r/atom nil))\r\n(def nuevo-valor (r/atom \"\"))\r\n\r\n(def estado-actualizacion (r/atom nil))\r\n\r\n(defn get-producto-por-id [id]\r\n  (some #(when (= (:id %) id) %) @list-productos))\r\n\r\n(defn obtener-id-categoria [nombre categorias]\r\n  (:id (first (filter #(= (:nombre %) nombre) categorias))))\r\n\r\n(defn get-categoria-por-id [id]\r\n  (some #(when (= (:id %) id) %) @categorias))\r\n\r\n(defn actualizar-producto [producto campo valor]\r\n  (let [id (:id @producto)\r\n        usuario-id (js/localStorage.getItem \"id\")\r\n        valor-parseado (case campo\r\n                         (\"es_vegetariano\" \"es_vegano\" \"es_sin_gluten\" \"es_sin_lactosa\") (= valor \"true\")\r\n                         (\"precio\" \"categoria_id\") (js/parseFloat valor)\r\n                         valor)\r\n        body-extendido (clj->js (assoc {}\r\n                                       campo valor-parseado\r\n                                       \"usuario_id\" usuario-id\r\n                                       \"_method\" \"PUT\"))\r\n        url (str \"/api/productos/\" id)\r\n        opciones #js {:method \"POST\"\r\n                      :headers #js {\"Content-Type\" \"application/json\"}\r\n                      :body (js/JSON.stringify body-extendido)}]\r\n    (-> (js/fetch url opciones)\r\n        (.then (fn [respuesta]\r\n                 (if (.-ok respuesta)\r\n                   (do\r\n                     (reset! estado-actualizacion (str \"Campo \" campo \" actualizado correctamente.\"))\r\n                     (if (= campo \"categoria_id\")\r\n                       (let [categoria (get-categoria-por-id valor-parseado)]\r\n                         (swap! producto assoc\r\n                                :categoria_id valor-parseado\r\n                                :nombre_categoria (:nombre categoria)))\r\n                       (swap! producto assoc (keyword campo) valor-parseado)))\r\n                   (reset! estado-actualizacion \"Error del servidor al actualizar campo.\"))))\r\n        (.catch (fn [e]\r\n                  (reset! estado-actualizacion \"Error del servidor al actualizar campo.\"))))))\r\n\r\n(defn actualizar-categoria [categoria campo valor]\r\n  (let [id (:id @categoria)\r\n        usuario-id (js/localStorage.getItem \"id\")\r\n        body (clj->js {\"usuario_id\" usuario-id\r\n                       campo valor})\r\n        url (str \"/api/categoria/\" id)\r\n        opciones #js {:method \"PUT\"\r\n                      :headers #js {\"Content-Type\" \"application/json\"}\r\n                      :body (js/JSON.stringify body)}]\r\n    (-> (js/fetch url opciones)\r\n        (.then (fn [respuesta]\r\n                 (if (.-ok respuesta)\r\n                   (do\r\n                     ;; Actualiza los datos localmente en la UI\r\n                     (swap! categoria assoc (keyword campo) valor)\r\n                     (reset! estado-actualizacion (str \"Campo \" campo \" actualizado correctamente.\")))\r\n                   (reset! estado-actualizacion \"Error del servidor al actualizar campo.\"))))\r\n        (.catch (fn [e]\r\n                  (reset! estado-actualizacion \"Error de red al actualizar.\"))))))\r\n\r\n\r\n\r\n(defn render-edicion-producto [producto]\r\n  [:div\r\n   [:h3 \"Selecciona el campo que quieres modificar:\"]\r\n   [:select {:value (or @campo-seleccionado \"\")\r\n             :on-change #(reset! campo-seleccionado (-> % .-target .-value))}\r\n    [:option {:value \"\"} \"-- Selecciona un campo --\"]\r\n    [:option {:value \"nombre\"} \"Nombre\"]\r\n    [:option {:value \"description\"} \"Descripci\u00f3n\"]\r\n    [:option {:value \"precio\"} \"Precio\"]\r\n    [:option {:value \"categoria_id\"} \"Categor\u00eda\"]\r\n    [:option {:value \"tipo_plato\"} \"Tipo de plato\"]\r\n    [:option {:value \"tipo_porcion\"} \"Tipo de porci\u00f3n\"]\r\n    [:option {:value \"es_vegetariano\"} \"Vegetariano\"]\r\n    [:option {:value \"es_vegano\"} \"Vegano\"]\r\n    [:option {:value \"es_sin_gluten\"} \"Sin gluten\"]\r\n    [:option {:value \"es_sin_lactosa\"} \"Sin lactosa\"]]\r\n\r\n   (when (not= @campo-seleccionado \"\")\r\n     [:div {:style {:margin-top \"15px\"}}\r\n      [:label (str \"Nuevo valor para el campo seleccionado: \")]\r\n      (cond\r\n        ;; Booleans\r\n        (#{\"es_vegetariano\" \"es_vegano\" \"es_sin_gluten\" \"es_sin_lactosa\"} @campo-seleccionado)\r\n        [:select {:value (or @nuevo-valor \"\")\r\n                  :on-change #(reset! nuevo-valor (-> % .-target .-value))}\r\n         [:option {:value \"\"} \"-- Selecciona una opci\u00f3n --\"]\r\n         [:option {:value \"true\"} \"S\u00ed\"]\r\n         [:option {:value \"false\"} \"No\"]]\r\n\r\n        ;; Tipo de plato con opciones espec\u00edficas\r\n        (= @campo-seleccionado \"tipo_porcion\")\r\n        [:select {:value (or @nuevo-valor \"\")\r\n                  :on-change #(reset! nuevo-valor (-> % .-target .-value))}\r\n         [:option {:value \"\"} \"-- Selecciona un tipo de porcion --\"]\r\n         [:option {:value \"Media raci\u00f3n\"} \"Media raci\u00f3n\"]\r\n         [:option {:value \"Raci\u00f3n completa\"} \"Raci\u00f3n completa\"]\r\n         [:option {:value \"Por unidad\"} \"Por unidad\"]]\r\n\r\n        (= @campo-seleccionado \"tipo_plato\")\r\n        [:select {:value (or @nuevo-valor \"\")\r\n                  :on-change #(reset! nuevo-valor (-> % .-target .-value))}\r\n         [:option {:value \"\"} \"-- Selecciona un tipo de plato --\"]\r\n         [:option {:value \"Tapa\"} \"Tapa\"]\r\n         [:option {:value \"Al centro\"} \"Al centro\"]\r\n         [:option {:value \"Principal\"} \"Principal\"]\r\n         [:option {:value \"Postres\"} \"Postres\"]]\r\n\r\n        ;; Categor\u00eda (muestra ID y nombre)\r\n        (= @campo-seleccionado \"categoria_id\")\r\n        [:select {:value (or @nuevo-valor \"\")\r\n                  :on-change #(reset! nuevo-valor (-> % .-target .-value))}\r\n         [:option {:value \"\"} \"-- Selecciona una categor\u00eda --\"]\r\n         (for [{:keys [id nombre]} @categorias]\r\n           ^{:key id} [:option {:value id} (str id \" - \" nombre)])]\r\n\r\n        ;; Resto de campos usan input libre\r\n        :else\r\n        [:input {:type \"text\"\r\n                 :value @nuevo-valor\r\n                 :placeholder (str (get @producto (keyword @campo-seleccionado)))\r\n                 :on-change #(reset! nuevo-valor (-> % .-target .-value))}])\r\n\r\n      [:br]\r\n      [:button {:on-click #(do\r\n                             (actualizar-producto producto @campo-seleccionado @nuevo-valor)\r\n                             (reset! nuevo-valor \"\"))}\r\n       \"Actualizar campo\"]])])\r\n\r\n\r\n(defn render-edicion-categoria [categoria]\r\n  [:div\r\n   [:h3 \"Selecciona el campo que quieres modificar:\"]\r\n   [:select {:value (or @campo-seleccionado \"\")\r\n             :on-change #(reset! campo-seleccionado (-> % .-target .-value))}\r\n    [:option {:value \"\"} \"-- Selecciona un campo --\"]\r\n    [:option {:value \"nombre\"} \"Nombre\"]\r\n    [:option {:value \"descripcion\"} \"Descripci\u00f3n\"]]\r\n\r\n   (when (not= @campo-seleccionado \"\")\r\n     [:div {:style {:margin-top \"15px\"}}\r\n      [:label (str \"Nuevo valor para el campo seleccionado: \")]\r\n      [:input {:type \"text\"\r\n               :value @nuevo-valor\r\n               :placeholder (str (get @categoria (keyword @campo-seleccionado)))\r\n               :on-change #(reset! nuevo-valor (-> % .-target .-value))}]\r\n\r\n      [:br]\r\n      [:button {:on-click #(do\r\n                             (actualizar-categoria categoria @campo-seleccionado @nuevo-valor)\r\n                             (reset! nuevo-valor \"\"))}\r\n       \"Actualizar campo\"]])])\r\n\r\n(defn page []\r\n  (let [params (get-in @current-route [:parameters :path])\r\n        tipo (:tipo params)\r\n        id (js/parseInt (:id params))]\r\n    (r/with-let [_ (reset! producto (get-producto-por-id id))]\r\n      (r/with-let [_ (reset! categoria (get-categoria-por-id id))]\r\n        (case tipo\r\n          \"producto\"\r\n          (if @producto\r\n            [:div.row {:class \"divEditar\"}\r\n             [:div.col-12 {:class \"volverAtras\"}\r\n              [:button\r\n               {:on-click #(set! (.-hash js/location) \"#/administracion\")}\r\n               \"Volver al panel de Administraci\u00f3n\"]]\r\n             [:div.col-12.col-md-6 {:class \"divDatos\"}\r\n              [:h1 \"Datos del producto seleccionado:\"]\r\n              [:p [:strong \"ID: \"] (:id @producto)]\r\n              [:p [:strong \"Nombre: \"] (:nombre @producto)]\r\n              [:p [:strong \"Descripci\u00f3n: \"] (:description @producto)]\r\n              [:p [:strong \"Precio: \"] (str (:precio @producto) \" \u20ac\")]\r\n              [:p [:strong \"Categor\u00eda: \"] (:nombre_categoria @producto)]\r\n              [:p [:strong \"Tipo de plato: \"] (:tipo_plato @producto)]\r\n              [:p [:strong \"Tipo de porci\u00f3n: \"] (:tipo_porcion @producto)]\r\n              [:h3 [:strong \"Restricciones alimentarias: \"]]\r\n              [:p [:strong \"Vegetariano: \"]\r\n               (if (:es_vegetariano @producto)\r\n                 [:span {:style {:color \"green\"}} \"\u2714\ufe0f\"]\r\n                 [:span {:style {:color \"red\"}} \"\u274c\"])]\r\n              [:p [:strong \"Vegano: \"]\r\n               (if (:es_vegano @producto)\r\n                 [:span {:style {:color \"green\"}} \"\u2714\ufe0f\"]\r\n                 [:span {:style {:color \"red\"}} \"\u274c\"])]\r\n              [:p [:strong \"Gluten: \"]\r\n               (if (:es_sin_gluten @producto)\r\n                 [:span {:style {:color \"green\"}} \"\u2714\ufe0f\"]\r\n                 [:span {:style {:color \"red\"}} \"\u274c\"])]\r\n              [:p [:strong \"Lactosa: \"]\r\n               (if (:es_sin_lactosa @producto)\r\n                 [:span {:style {:color \"green\"}} \"\u2714\ufe0f\"]\r\n                 [:span {:style {:color \"red\"}} \"\u274c\"])]]\r\n             [:div.col-12.col-md-6 {:class \"divActualizar\"}\r\n              [render-edicion-producto producto]]]\r\n            [:div {:class \"divEditar\"} \"Producto no encontrado\"])\r\n\r\n          \"categoria\"\r\n          (if @categoria\r\n            [:div.row {:class \"divEditar\"}\r\n             [:div.col-12 {:class \"volverAtras\"}\r\n              [:button\r\n               {:on-click #(set! (.-hash js/location) \"#/administracion\")}\r\n               \"Volver al panel de Administraci\u00f3n\"]]\r\n             [:div.col-12.col-md-6 {:class \"divDatos\"}\r\n              [:h1 \"Editar categor\u00eda:\"]\r\n              [:p [:strong \"ID: \"] (:id @categoria)]\r\n              [:p [:strong \"Nombre: \"] (:nombre @categoria)]\r\n              [:p [:strong \"Descripci\u00f3n: \"] (:descripcion @categoria)]]\r\n             [:div.col-12.col-md-6 {:class \"divActualizar\"}\r\n              [render-edicion-categoria categoria]]]\r\n            [:div {:class \"divEditar\"} \"Producto no encontrado\"]))))))\r\n\r\n\r\n\r\n"]}