{"version":3,"sources":["home/core.cljs"],"mappings":";AAMA,GAAA,QAAAA,iCAAAC,sCAAAC;AAAA;AAAA,AAAA,AAASC,mBAAO,gDAAA,hDAACC;;AAGjB,+BAAA,/BAAMC,sEAAoBC;AAA1B,AACE,IAAMC,OAAK,AAACC,gBAAM,AAAS,AAAUF;AAArC,AACE,oBAAM,iBAAAG,oBAAKF;AAAL,AAAA,oBAAAE;AAAA,IAAAA,wBAAU,cAAA,bAAI,AAAQF;AAAtB,AAAA,GAAAE;AAAqC,4BAAA,rBAACC,mDAA0C,AAAQH;;AAAxFE;;;AAAAA;;;AAAN,AACE,8CAAA,vCAACE,sBAAOR,oGAAQI;;AADlB;;;AAIJ,yBAAA,zBAAMK;AAAN,AACE,GAAI,GAAK,uBAAA,AAAAC,vBAACC,uCAAQX;AAChB,IAAMY,YAAU,KAAAC;AAAhB,AACE,iBAAA,jBAASD,0BAAmB,gBAAA,AAAAF,hBAACL,gCAAOL;;AACpC,kEAAA,sEAAA,2CAAA,gEAAA,2EAAA,qDAAA,5WAACc,kOACiBF,2MAEM,WAAKG;AAAL,AACE,MAAA,NAACC;;AACD,OAACC;GAL3B,gEAMwB,WAAKF;AAAL,AACE,aAAA,NAACC;;;AAV/B;;;AAYF,6BAAA,7BAAME;AAAN,AACE,eAAA,AAAAR,XAAMS,2BAAUC;AAAhB,AACE,GAAI,AAACT,uBAAOQ;AAAZ,0FAAA,mDAAA;;AAAA,0FAAA,qEAAA,2CAAA,kDAAA,0BAAA,wDAAA,iBAAA,8DAAA,mBAAA,mFAAA,iFAII,iBAAAE,qBAAA,mDAAAC;AAAA,AAAA,YAAAC,kBAAA,KAAA;AAAA,AAAA,IAAAD,eAAAA;;AAAA,AAAA,IAAAE,qBAAA,AAAAC,cAAAH;AAAA,AAAA,GAAAE;AAAA,AAAA,IAAAF,eAAAE;AAAA,AAAA,GAAA,AAAAE,6BAAAJ;AAAA,IAAAK,kBAm7E2C,AAAA+B,sBAAApC;IAn7E3CM,qBAAA,AAAAC,gBAAAF;IAAAG,WAAA,AAAAC,uBAAAH;AAAA,AAAA,GAAA,AAAA,iBAAAI,WAAA;;AAAA,AAAA,GAAA,CAAAA,WAAAJ;AAAA,IAAAK,aAAA,AAAAC,eAAAP,gBAAAK;IAAAC,iBAAA,AAAAE,4BAAAF;SAAA,AAAAG,4CAAAH,eAAA,hEAAcY;kBAAd,AAAAT,4CAAAH,eAAA,zEAAiBa;oBAAjB,AAAAV,4CAAAH,eAAA,3EAA6Bc;gBAA7B,AAAAX,4CAAAH,eAAA,vEAA2Ce;AAA3C,AAAA,AAAA,AAAAX,uBAAAP,SAAA,oBAAA,mFAAA,+EAAA,2CAAA,0PAAA,mFAAA,mDAAA,2CAAA,wDAAA,wCAAA,mFAAA,mDAAA,2CAAA,oMAAA,6FAAA,2CAAA,oDACSe,pgCACqB,6KAAA,SAAA,pLAAI,AAACI,6CAAEJ,GAAG,AAACxC,gBAAM,4CAAA,5CAAC6C,8FAAQ/B,whBAExC,CAAA,+DAAA,XAAa6B,kEAAqBD,0EAClCD;;AALhB,eAAA,CAAAd,WAAA;;;;AAAA;;;;;AAAA,OAAAM,qBAAA,AAAAC,gBAAAT,UAAA,AAAAU,yCAAA,AAAAC,qBAAAnB;;AAAA,OAAAgB,qBAAA,AAAAC,gBAAAT,UAAA;;;AAAA,IAAAY,aAAA,AAAArC,gBAAAiB;IAAAoB,iBAAA,AAAAP,4BAAAO;SAAA,AAAAN,4CAAAM,eAAA,hEAAcG;kBAAd,AAAAT,4CAAAM,eAAA,zEAAiBI;oBAAjB,AAAAV,4CAAAM,eAAA,3EAA6BK;gBAA7B,AAAAX,4CAAAM,eAAA,vEAA2CM;AAA3C,AAAA,OAAAL,eAAA,oBAAA,mFAAA,+EAAA,2CAAA,0PAAA,mFAAA,mDAAA,2CAAA,wDAAA,wCAAA,mFAAA,mDAAA,2CAAA,oMAAA,6FAAA,2CAAA,gEAAA,AAAAH,yCAAA,AAAAI,eAAAtB,pEACSuB,pgCACqB,6KAAA,SAAA,pLAAI,AAACI,6CAAEJ,GAAG,AAACxC,gBAAM,4CAAA,5CAAC6C,8FAAQ/B,whBAExC,CAAA,+DAAA,XAAa6B,kEAAqBD,0EAClCD;;;AALhB;;;;GAAA,KAAA;;AAAA,AAAA,OAAAzB,mBAAuDF;aAJ3D,mFAAA,oGAAA,2CAAA,qDAAA,2BAAA,qDAAA,SAAA,iEAAA,eAAA,mFAAA,2GAAA,2CAAA,kEAAA,uBAAA,mFAAA,qEAAA,2BAAA,mFAAA,qGAAA,2CAAA,qDAAA,2BAAA,qDAAA,SAAA,iEAAA,eAAA,mFAAA,2GAAA,2CAAA,kEAAA,uBAAA,mFAAA,qEAAA;;;AAoBJ,8BAAA,9BAAMgC;AAAN,AAAA,0FAAA,mDAAA,2CAAA,wDAAA,sBAAA,mFAAA,iDAAA,uBAAA,mFAAA,sDAAA,2CAAA,qDAAA,OAAA,4GAAA,mFAAA,yDAAA,2CAAA,4FAAA,hUAIuBjD,iSACAO;;AAGvB,iBAAA,jBAAM2C;AAAN,AACE,+DAAA,2CAAA,nGAACC,uLAEC;AAAA,AACE,YAAA,ZAACC;;AACD,OAACrC;GAJL,yEAME;AAAA,AAAA,0FAAA,0DAAA,mFAAA,gEAAA,2CAAA,wDAAA,oBAAA,mFAAA,iDAAA,wCAAA,mFAIKC;;;AAKT,iBAAA,jBAAMqC;AAAN,AACE,wDAAA,jDAACC,oIAAYJ,uBAAM,wBAAA,xBAAiBK;;AACtC,AAACF","names":["js/home","js/home.core","js/home.core.imagen","home.core/imagen","reagent.core.atom","home.core/handle-file-change","event","file","cljs.core/first","and__5000__auto__","cljs.core/re-matches","cljs.core/reset!","home.core/subir-imagen","cljs.core/deref","cljs.core/empty?","form-data","js/FormData","cljs_http.client.post","response","js/alert","app.db/cargar-imagenes","home.core/mostrar-imagenes","imagenes","app.db/imagenes","iter__5480__auto__","s__26478","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__26480","cljs.core/chunk-buffer","i__26479","map__26486","cljs.core/-nth","cljs.core/--destructure-map","cljs.core.get","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__26477","cljs.core/chunk-rest","map__26491","cljs.core/cons","cljs.core/rest","id","descripcion","imagen_base64","mime_type","cljs.core._EQ_","cljs.core.map","home.core/formulario-subida","home.core/page","reagent.core.create_class","js/console.log","home.core/init","reagent.dom.render","js/document","cljs.core/chunk-first"],"sourcesContent":["(ns home.core\r\n  (:require [reagent.core :as r]\r\n            [reagent.dom :as dom]\r\n            [cljs-http.client :as http]\r\n            [app.db :as db]))\r\n\r\n(defonce imagen (r/atom nil)) ;; \u00c1tomo para almacenar la imagen seleccionada\r\n\r\n;; Funci\u00f3n para manejar el cambio de archivo\r\n(defn handle-file-change [event]\r\n  (let [file (first (.-files (.-target event)))]\r\n    (when (and file (<= (.-size file) 2048000) (re-matches #\".*\\.(jpg|jpeg|png|gif|svg)$\" (.-name file)))\r\n      (reset! imagen [file]))))\r\n\r\n;; Funci\u00f3n para subir la imagen\r\n(defn subir-imagen []\r\n  (if (not (empty? @imagen))\r\n    (let [form-data (js/FormData.)]\r\n      (.append form-data \"imagen\" (first @imagen)) ;; Agrega la imagen al formulario\r\n      (http/post \"/api/subir-imagen\"\r\n                 {:body form-data\r\n                  :response-format :json\r\n                  :on-success (fn [response]\r\n                                (js/alert \"Imagen subida con \u00e9xito\")\r\n                                (db/cargar-imagenes)) \r\n                  :on-failure (fn [response]\r\n                                (js/alert \"Error al subir la imagen\"))}))))\r\n\r\n(defn mostrar-imagenes []\r\n  (let [imagenes @db/imagenes]  ;; Obtencion de las im\u00e1genes desde el atom\r\n    (if (empty? imagenes)\r\n      [:div \"No se encontraron im\u00e1genes.\"]\r\n      [:div.carousel {:id \"carouselExampleControls\" :class \"carousel slide\" :data-ride \"carousel\"}\r\n       [:div.carousel-inner\r\n        (for [{:keys [id descripcion imagen_base64 mime_type]} imagenes]\r\n          ^{:key id}\r\n          [:div.carousel-item {:class (if (= id (first (map :id imagenes))) \"active\" \"\")}\r\n           [:div {:class \"d-flex justify-content-center\"}  ;; Asegura que la imagen est\u00e9 centrada en el carrusel\r\n            [:img {:src (str \"data:\" mime_type \";base64,\" imagen_base64)\r\n                   :alt descripcion}]]])]\r\n       ;; Botones laterales del carrusel, para navegar entre las im\u00e1genes\r\n       [:button.carousel-control-prev {:href \"#carouselExampleControls\" :role \"button\" :data-slide \"prev\"}\r\n        [:span.carousel-control-prev-icon {:aria-hidden \"true\"}]\r\n        [:span.sr-only \"Previous\"]]\r\n       [:button.carousel-control-next {:href \"#carouselExampleControls\" :role \"button\" :data-slide \"next\"}\r\n        [:span.carousel-control-next-icon {:aria-hidden \"true\"}]\r\n        [:span.sr-only \"Next\"]]])))\r\n\r\n;; Formulario para subir imagenes a la base de datos\r\n;; En este caso, solo permite subir imagenes de 1 en 1\r\n(defn formulario-subida []\r\n  [:div {:class \"divImagenes\"}\r\n   [:h2 \"Subir Imagen\"]\r\n   [:input {:type \"file\"\r\n            :on-change handle-file-change}]\r\n   [:button {:on-click subir-imagen} \"Subir Imagen\"]])\r\n\r\n;; Funcion page para estructurar la pagina\r\n(defn page []\r\n  (r/create-class\r\n   {:component-did-mount\r\n    (fn []\r\n      (js/console.log \"Componente montado. Llamando a cargar-imagenes...\")\r\n      (db/cargar-imagenes))\r\n    :reagent-render\r\n    (fn []\r\n      [:div.row \r\n       [:div.col-12 {:class \"container\"}\r\n        [:h3 \"Galer\u00eda de Im\u00e1genes\"]\r\n        [mostrar-imagenes]\r\n              ;;  [formulario-subida]\r\n        ]])}))\r\n\r\n;; Inicializa la app\r\n(defn init []\r\n  (dom/render [page] (.getElementById js/document \"app\")))\r\n(init)\r\n"]}