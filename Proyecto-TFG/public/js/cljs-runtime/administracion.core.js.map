{"version":3,"sources":["administracion/core.cljs"],"mappings":"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","names":["js/administracion","js/administracion.core","js/administracion.core.logged-in?","administracion.core/logged-in?","reagent.core.atom","js/administracion.core.loading?","administracion.core/loading?","js/administracion.core.usuario","administracion.core/usuario","js/administracion.core.contrasenia","administracion.core/contrasenia","administracion.core/sesion-verificada?","js/administracion.core.datos-usuario","administracion.core/datos-usuario","js/administracion.core.auth-token","administracion.core/auth-token","js/administracion.core.mostrar-productos?","administracion.core/mostrar-productos?","js/administracion.core.mostrar-categorias?","administracion.core/mostrar-categorias?","js/administracion.core.categoria-busqueda","administracion.core/categoria-busqueda","js/administracion.core.producto-busqueda","administracion.core/producto-busqueda","administracion.core/verificar-sesion","ajax.core.GET","response","cljs.core/reset!","_","administracion.core/render-categorias","cljs.core/deref","p1__42359#","texto","clojure.string/lower-case","categorias-filtradas","p1__42358#","cljs.core.filter","clojure.string/includes?","app.db/categorias","iter__5480__auto__","s__42370","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__42372","cljs.core/chunk-buffer","i__42371","map__42384","cljs.core/-nth","cljs.core/--destructure-map","cljs.core.get","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__42369","cljs.core/chunk-rest","map__42389","cljs.core/first","cljs.core/cons","cljs.core/rest","id","nombre","descripcion","app.state/acceso-editar?","js/location","app.db/eliminar-categoria","app.state/acceso-nuevo?","administracion.core/render-productos","p1__42395#","productos-filtradas","p1__42394#","app.db/list-productos","s__42400","b__42402","i__42401","map__42403","iter__42399","map__42406","description","precio","nombre_categoria","tipo_plato","tipo_porcion","app.db/eliminar-producto","administracion.core/login","p1__42408#","p1__42409#","ajax.core.POST","js/localStorage.setItem","resp","js/console.log","err","cljs.core.println","js/alert","p1__42417#","p1__42418#","administracion.core/login-form","administracion.core/logout","js/localStorage.removeItem","e","administracion.core/admin-panel","cljs.core/not","cljs.core._EQ_","app.db/fetch-list-productos","app.db/fetch-list-categorias","app.state/acceso-imagenes?","administracion.core/page","administracion.core/init","reagent.dom.render","js/document","cljs.core/chunk-first"],"sourcesContent":["(ns administracion.core\r\n  (:require [reagent.core :as r]\r\n            [app.state :as state]\r\n            [ajax.core :refer [GET POST]]\r\n            [app.db :refer [list-productos fetch-list-productos categorias fetch-list-categorias eliminar-categoria eliminar-producto]]\r\n            [reagent.dom :as dom]\r\n            [reitit.frontend.easy :as rfe]))\r\n\r\n(defonce logged-in? (r/atom nil))\r\n(defonce loading? (r/atom false))\r\n(defonce usuario (r/atom \"\"))\r\n(defonce contrasenia (r/atom \"\"))\r\n(def sesion-verificada? (r/atom false))\r\n(defonce datos-usuario (r/atom nil))\r\n(defonce auth-token (r/atom nil))\r\n(defonce mostrar-productos? (r/atom false))\r\n(defonce mostrar-categorias? (r/atom false))\r\n\r\n(defonce categoria-busqueda (r/atom \"\"))\r\n(defonce producto-busqueda (r/atom \"\"))\r\n\r\n(defn verificar-sesion []\r\n  (GET \"/api/admin\"\r\n    {:with-credentials? true\r\n     :handler (fn [response]\r\n                (reset! logged-in? true)\r\n                (reset! datos-usuario (:usuario response))\r\n                (reset! sesion-verificada? true))\r\n     :error-handler (fn [_]\r\n                      (reset! logged-in? false)\r\n                      (reset! datos-usuario nil)\r\n                      (reset! sesion-verificada? true))}))\r\n\r\n(defn render-categorias []\r\n  (let [texto (clojure.string/lower-case @categoria-busqueda)\r\n        categorias-filtradas (filter #(clojure.string/includes?\r\n                                       (clojure.string/lower-case (:nombre %))\r\n                                       texto)\r\n                                     @categorias)]\r\n    [:div.col-12\r\n     [:h3 \"Lista de categorias\"]\r\n     ;; Caja de b\u00fasqueda\r\n     [:input.form-control.mb-3\r\n      {:type \"text\"\r\n       :placeholder \"Buscar categor\u00eda por nombre...\"\r\n       :value @categoria-busqueda\r\n       :on-change #(reset! categoria-busqueda (-> % .-target .-value))}]\r\n     [:table {:class \"table table-striped\"}\r\n      [:thead\r\n       [:tr\r\n        [:th {:class \"id\"} \"ID\"] [:th \"Nombre\"] [:th.d-none.d-sm-table-cell \"Descripcion\"] [:th {:class \"tdButton\"} \"Editar\"] [:th {:class \"tdButton\"} \"Eliminar\"]]]\r\n      [:tbody\r\n       (for [{:keys [id nombre descripcion]} categorias-filtradas]\r\n         ^{:key id}\r\n         [:tr\r\n          [:td {:class \"tdButton\"} id] [:td nombre] [:td.d-none.d-sm-table-cell descripcion]\r\n          [:td {:class \"tdButton\"}\r\n           [:button\r\n            {:on-click #(do\r\n                          (reset! app.state/acceso-editar? true)\r\n                          (set! (.-hash js/location) (str \"/editar/categoria/\" id)))}\r\n            \"Editar\"]]\r\n          [:td {:class \"tdButton\"} [:button\r\n                                    {:on-click #(eliminar-categoria id)}\r\n                                    \"Eliminar\"]]])\r\n       [:tr\r\n        [:td\r\n         [:button\r\n          {:on-click\r\n           #(do\r\n              (reset! app.state/acceso-nuevo? true)\r\n              (set! (.-hash js/location) \"/nuevo/categoria\"))\r\n           :class \"nuevo\"}\r\n          \"A\u00f1adir nueva categoria\"]]]]]]))\r\n\r\n(defn render-productos []\r\n  (let [texto (clojure.string/lower-case @producto-busqueda)\r\n        productos-filtradas (filter #(clojure.string/includes?\r\n                                      (clojure.string/lower-case (:nombre %))\r\n                                      texto)\r\n                                    @list-productos)]\r\n    [:div.col-12\r\n     [:h3 \"Lista de productos\"]\r\n     [:input.form-control.mb-3\r\n      {:type \"text\"\r\n       :placeholder \"Buscar producto por nombre...\"\r\n       :value @producto-busqueda\r\n       :on-change #(reset! producto-busqueda (-> % .-target .-value))}]\r\n     [:table {:class \"table table-striped\"}\r\n      [:thead\r\n       [:tr\r\n        [:th {:class \"id\"} \"ID\"] [:th \"Nombre\"] [:th.d-none.d-lg-table-cell \"Descripcion\"] [:th.d-none.d-sm-table-cell \"Precio\"]\r\n        [:th.d-none.d-lg-table-cell \"Categor\u00eda\"] [:th.d-none.d-lg-table-cell \"Tipo de plato\"] [:th \"Tipo de porci\u00f3n\"]\r\n        [:th \"Editar\"] [:th \"Eliminar\"]]]\r\n      [:tbody\r\n       (for [{:keys [id nombre description precio nombre_categoria tipo_plato tipo_porcion]} productos-filtradas]\r\n         ^{:key id}\r\n         [:tr\r\n          [:td {:class \"id\"} id] [:td nombre] [:td.d-none.d-lg-table-cell description] [:td.d-none.d-sm-table-cell (str precio \" \u20ac\")]\r\n          [:td.d-none.d-lg-table-cell nombre_categoria] [:td.d-none.d-lg-table-cell tipo_plato] [:td tipo_porcion]\r\n          [:td {:class \"tdButton\"}\r\n           [:button\r\n            {:on-click #(do\r\n                          (reset! app.state/acceso-editar? true)\r\n                          (set! (.-hash js/location) (str \"/editar/producto/\" id)))}\r\n            \"Editar\"]]\r\n          [:td {:class \"tdButton\"} [:button\r\n                                    {:on-click #(eliminar-producto id)}\r\n                                    \"Eliminar\"]]])\r\n       [:tr\r\n        [:td\r\n         [:button\r\n          {:on-click\r\n           #(do\r\n              (reset! app.state/acceso-nuevo? true)\r\n              (set! (.-hash js/location) \"/nuevo/producto\"))\r\n           :class \"nuevo\"}\r\n          \"A\u00f1adir nuevo producto\"]]]]]]))\r\n\r\n(defn login []\r\n  (POST \"/api/login\"\r\n    {:params {:nombre @usuario\r\n              :contrasenia @contrasenia}\r\n     :format :json\r\n     :response-format :json\r\n     :keywords? true\r\n     :with-credentials? true ;; <-- tambi\u00e9n aqu\u00ed para que Laravel devuelva la cookie\r\n     :handler #(do\r\n                 ;; Limpia cualquier estado anterior\r\n                 (reset! auth-token nil)\r\n                 (reset! logged-in? true)\r\n                 (reset! datos-usuario {:nombre (:nombre %) :rol (:rol %)})\r\n                 (js/localStorage.setItem \"id\" (:id %))\r\n\r\n                 ;; Y ahora verifica el rol desde el backend\r\n                 (GET \"/api/admin\"\r\n                   {:with-credentials? true\r\n                    :handler (fn [resp]\r\n                               (js/console.log \"Verificado como admin\" resp))\r\n                    :error-handler (fn [err]\r\n                                     (js/console.log \"No eres admin\" err))}))\r\n\r\n     :error-handler #(do\r\n                       (println \"Error en la solicitud: \" %)\r\n                       (js/alert \"Credenciales incorrectas.\")\r\n                       (reset! loading? false))}))\r\n\r\n(defn login-form []\r\n  [:div.row {:class \"administracion\"}\r\n   [:div {:class \"entrada\"}\r\n    [:div.col-12\r\n     [:p \"Nombre de usuario: \"\r\n      [:input {:type \"text\"\r\n               :placeholder \"Ingrese su nombre de usuario\"\r\n               :value @usuario\r\n               :on-change #(reset! usuario (-> % .-target .-value))}]]\r\n     [:p \"Contrase\u00f1a: \"\r\n      [:input {:type \"password\"\r\n               :placeholder \"Ingrese su contrase\u00f1a\"\r\n               :value @contrasenia\r\n               :on-change #(reset! contrasenia (-> % .-target .-value))}]]]\r\n    [:div.row {:class \"rowButton\"}\r\n     [:div.col-12\r\n      [:button {:on-click login} \"Entrar\"]]]]])\r\n\r\n(defn logout []\r\n  (POST \"/api/logout\"\r\n    {:with-credentials? true\r\n     :handler (fn [_]\r\n                (reset! logged-in? false)\r\n                (reset! datos-usuario {:nombre nil :rol nil})\r\n                (js/localStorage.removeItem \"id\"))\r\n     :error-handler (fn [e]\r\n                      (js/console.log \"Error cerrando sesi\u00f3n\" e))}))\r\n\r\n(defn admin-panel []\r\n  (cond\r\n    (not @sesion-verificada?)\r\n    [:div \"Cargando sesi\u00f3n...\"]\r\n\r\n    (nil? @datos-usuario)\r\n    [:div.row {:class \"panel\"}\r\n     [:div.col-12 {:class \"panelBotones\"}\r\n      [:h2 \"Aviso importante!!!\"]\r\n      [:p \"No estas logeado, debes de cerrar sesion y logearte correctamente.\"]\r\n      [:button {:on-click #(do\r\n                             (logout)\r\n                             (.reload js/location true))}\r\n       \"Cerrar sesi\u00f3n\"]]]\r\n\r\n    (not @logged-in?)  ;; ya se verific\u00f3 y no est\u00e1 logueado\r\n    [:div \"Acceso denegado.\"]\r\n\r\n    :else ;; ya est\u00e1 todo listo\r\n    [:div.row {:class \"panel\"}\r\n     [:div.col-12 {:class \"panelBotones\"}\r\n      [:h2 (str \"Bienvenido/a, \" (:nombre @datos-usuario) \"!\")]\r\n      [:p (str \"Tienes permisos, \" (:rol @datos-usuario))]\r\n      [:p \"Tienes acceso al panel de administraci\u00f3n.\"]\r\n      [:button {:on-click #(do\r\n                             (logout)\r\n                             (.reload js/location true))}\r\n       \"Cerrar sesi\u00f3n\"]\r\n      (when (= (:rol @datos-usuario) \"admin\")\r\n        [:div {:class \"botonesAdmin\"}\r\n         [:p \"Eres administrador. Puedes editar el contenido.\"]\r\n         [:button {:on-click #(do\r\n                                (reset! mostrar-productos? true)\r\n                                (reset! mostrar-categorias? false)\r\n                                (fetch-list-productos))}\r\n          \"Mostrar productos\"]\r\n         [:button {:on-click #(do\r\n                                (reset! mostrar-categorias? true)\r\n                                (reset! mostrar-productos? false)\r\n                                (fetch-list-categorias))}\r\n          \"Mostrar categor\u00edas\"]\r\n         [:button\r\n          {:on-click #(do\r\n                        (reset! app.state/acceso-imagenes? true)\r\n                        (set! (.-hash js/location) \"#/imagenes\"))}\r\n          \"Mostrar fotograf\u00edas\"]])]\r\n\r\n     (when @mostrar-productos?\r\n       [render-productos])\r\n     (when @mostrar-categorias?\r\n       [render-categorias])]))\r\n\r\n\r\n(defn page []\r\n  (cond\r\n    (not @sesion-verificada?) [:p {:class \"administracion\"} \"Verificando sesi\u00f3n...\"]\r\n    @logged-in? [admin-panel]\r\n    :else [login-form]))\r\n\r\n\r\n;; Monta la aplicaci\u00f3n en el DOM\r\n(defn init []\r\n  (verificar-sesion)\r\n  (dom/render [page] (.getElementById js/document \"app\")))\r\n\r\n;; Llamar la funci\u00f3n init para iniciar la aplicaci\u00f3n\r\n(init)\r\n"]}