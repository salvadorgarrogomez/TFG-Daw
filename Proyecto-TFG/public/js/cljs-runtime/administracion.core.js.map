{"version":3,"sources":["administracion/core.cljs"],"mappings":"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","names":["js/administracion","js/administracion.core","js/administracion.core.logged-in?","administracion.core/logged-in?","reagent.core.atom","js/administracion.core.loading?","administracion.core/loading?","js/administracion.core.usuario","administracion.core/usuario","js/administracion.core.contrasenia","administracion.core/contrasenia","js/administracion.core.datos-usuario","administracion.core/datos-usuario","js/administracion.core.auth-token","administracion.core/auth-token","administracion.core/login","cljs.core/deref","cljs.core.println","cljs.core/reset!","p1__13443#","p1__13444#","ajax.core.POST","js/alert","p1__13445#","p1__13446#","administracion.core/login-form","administracion.core/logout","administracion.core/admin-panel","cljs.core._EQ_","administracion.core/page","administracion.core/init","reagent.dom.render","js/document"],"sourcesContent":["(ns administracion.core\r\n  (:require [reagent.core :as r]\r\n            [ajax.core :refer [POST]]\r\n            [reagent.dom :as dom]))\r\n\r\n(defonce logged-in? (r/atom false))\r\n(defonce loading? (r/atom false))\r\n(defonce usuario (r/atom \"\"))\r\n(defonce contrasenia (r/atom \"\"))\r\n(defonce datos-usuario (r/atom {:nombre nil :rol nil}))\r\n(defonce auth-token (r/atom nil))\r\n\r\n(defn login []\r\n  (println \"Usuario:\" @usuario \" Contrase\u00f1a:\" @contrasenia)\r\n  (reset! loading? true)\r\n  (POST \"/api/login-admin\"\r\n    {:params {:nombre @usuario\r\n              :contrasenia @contrasenia}\r\n     :format :json\r\n     :response-format :json\r\n     :keywords? true\r\n     :handler #(do\r\n                 (println \"Respuesta del servidor: \" %)\r\n                 (reset! auth-token (:token %))\r\n                 (reset! logged-in? true)\r\n                 (reset! datos-usuario {:nombre (:nombre %) :rol (:rol %)}))\r\n     :error-handler #(do\r\n                       (println \"Error en la solicitud: \" %)\r\n                       (js/alert \"Credenciales incorrectas.\")\r\n                       (reset! loading? false))}))\r\n\r\n(defn login-form []\r\n  [:div.row {:class \"administracion\"}\r\n   [:div {:class \"entrada\"}\r\n    [:div.col-12\r\n     [:p \"Nombre de usuario: \"\r\n      [:input {:type \"text\"\r\n               :placeholder \"Ingrese su nombre de usuario\"\r\n               :value @usuario\r\n               :on-change #(reset! usuario (-> % .-target .-value))}]]\r\n     [:p \"Contrase\u00f1a: \"\r\n      [:input {:type \"password\"\r\n               :placeholder \"Ingrese su contrase\u00f1a\"\r\n               :value @contrasenia\r\n               :on-change #(reset! contrasenia (-> % .-target .-value))}]]]\r\n    [:div.row {:class \"rowButton\"}\r\n     [:div.col-12 \r\n      [:button {:on-click login} \"Entrar\"]]]]])\r\n\r\n(defn logout []\r\n  (reset! logged-in? false)\r\n  (reset! auth-token nil)\r\n  (reset! datos-usuario {:nombre nil :rol nil}))\r\n\r\n(defn admin-panel []\r\n  [:div {:class \"panel\"}\r\n   [:h2 (str \"Bienvenido, \" (:nombre @datos-usuario) \"!\")]\r\n   [:p (str \"Tu rol es: \" (:rol @datos-usuario))]\r\n   [:p \"Tienes acceso al panel de administraci\u00f3n.\"]\r\n   [:button {:on-click logout} \"Cerrar sesi\u00f3n\"]\r\n   (when (= (:rol @datos-usuario) \"administrador\")\r\n     [:p \"Eres administrador. Puedes editar el contenido.\"])])\r\n\r\n(defn page []\r\n  (if @logged-in?\r\n    [admin-panel]\r\n    [login-form]))\r\n\r\n;; Montar la aplicaci\u00f3n en el DOM\r\n(defn init []\r\n  (dom/render [page] (.getElementById js/document \"app\")))  ;; Usa reagent.dom/render\r\n\r\n;; Llamar la funci\u00f3n init para iniciar la aplicaci\u00f3n\r\n(init)\r\n"]}