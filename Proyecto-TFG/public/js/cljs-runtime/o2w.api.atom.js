goog.provide('o2w.api.atom');

/**
 * @interface
 */
o2w.api.atom.IapiAtom = function(){};

var o2w$api$atom$IapiAtom$fetch_BANG_$dyn_12729 = (function (this$){
var x__5350__auto__ = (((this$ == null))?null:this$);
var m__5351__auto__ = (o2w.api.atom.fetch_BANG_[goog.typeOf(x__5350__auto__)]);
if((!((m__5351__auto__ == null)))){
return (m__5351__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5351__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5351__auto__.call(null, this$));
} else {
var m__5349__auto__ = (o2w.api.atom.fetch_BANG_["_"]);
if((!((m__5349__auto__ == null)))){
return (m__5349__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5349__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5349__auto__.call(null, this$));
} else {
throw cljs.core.missing_protocol("IapiAtom.fetch!",this$);
}
}
});
o2w.api.atom.fetch_BANG_ = (function o2w$api$atom$fetch_BANG_(this$){
if((((!((this$ == null)))) && ((!((this$.o2w$api$atom$IapiAtom$fetch_BANG_$arity$1 == null)))))){
return this$.o2w$api$atom$IapiAtom$fetch_BANG_$arity$1(this$);
} else {
return o2w$api$atom$IapiAtom$fetch_BANG_$dyn_12729(this$);
}
});

var o2w$api$atom$IapiAtom$clean_BANG_$dyn_12730 = (function (this$){
var x__5350__auto__ = (((this$ == null))?null:this$);
var m__5351__auto__ = (o2w.api.atom.clean_BANG_[goog.typeOf(x__5350__auto__)]);
if((!((m__5351__auto__ == null)))){
return (m__5351__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5351__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5351__auto__.call(null, this$));
} else {
var m__5349__auto__ = (o2w.api.atom.clean_BANG_["_"]);
if((!((m__5349__auto__ == null)))){
return (m__5349__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5349__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5349__auto__.call(null, this$));
} else {
throw cljs.core.missing_protocol("IapiAtom.clean!",this$);
}
}
});
o2w.api.atom.clean_BANG_ = (function o2w$api$atom$clean_BANG_(this$){
if((((!((this$ == null)))) && ((!((this$.o2w$api$atom$IapiAtom$clean_BANG_$arity$1 == null)))))){
return this$.o2w$api$atom$IapiAtom$clean_BANG_$arity$1(this$);
} else {
return o2w$api$atom$IapiAtom$clean_BANG_$dyn_12730(this$);
}
});

var o2w$api$atom$IapiAtom$refresh_BANG_$dyn_12731 = (function (this$){
var x__5350__auto__ = (((this$ == null))?null:this$);
var m__5351__auto__ = (o2w.api.atom.refresh_BANG_[goog.typeOf(x__5350__auto__)]);
if((!((m__5351__auto__ == null)))){
return (m__5351__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5351__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5351__auto__.call(null, this$));
} else {
var m__5349__auto__ = (o2w.api.atom.refresh_BANG_["_"]);
if((!((m__5349__auto__ == null)))){
return (m__5349__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5349__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5349__auto__.call(null, this$));
} else {
throw cljs.core.missing_protocol("IapiAtom.refresh!",this$);
}
}
});
o2w.api.atom.refresh_BANG_ = (function o2w$api$atom$refresh_BANG_(this$){
if((((!((this$ == null)))) && ((!((this$.o2w$api$atom$IapiAtom$refresh_BANG_$arity$1 == null)))))){
return this$.o2w$api$atom$IapiAtom$refresh_BANG_$arity$1(this$);
} else {
return o2w$api$atom$IapiAtom$refresh_BANG_$dyn_12731(this$);
}
});

var o2w$api$atom$IapiAtom$ensure_BANG_$dyn_12732 = (function (this$,cb){
var x__5350__auto__ = (((this$ == null))?null:this$);
var m__5351__auto__ = (o2w.api.atom.ensure_BANG_[goog.typeOf(x__5350__auto__)]);
if((!((m__5351__auto__ == null)))){
return (m__5351__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5351__auto__.cljs$core$IFn$_invoke$arity$2(this$,cb) : m__5351__auto__.call(null, this$,cb));
} else {
var m__5349__auto__ = (o2w.api.atom.ensure_BANG_["_"]);
if((!((m__5349__auto__ == null)))){
return (m__5349__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5349__auto__.cljs$core$IFn$_invoke$arity$2(this$,cb) : m__5349__auto__.call(null, this$,cb));
} else {
throw cljs.core.missing_protocol("IapiAtom.ensure!",this$);
}
}
});
o2w.api.atom.ensure_BANG_ = (function o2w$api$atom$ensure_BANG_(this$,cb){
if((((!((this$ == null)))) && ((!((this$.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2 == null)))))){
return this$.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2(this$,cb);
} else {
return o2w$api$atom$IapiAtom$ensure_BANG_$dyn_12732(this$,cb);
}
});

var o2w$api$atom$IapiAtom$loading_QMARK_$dyn_12733 = (function (this$){
var x__5350__auto__ = (((this$ == null))?null:this$);
var m__5351__auto__ = (o2w.api.atom.loading_QMARK_[goog.typeOf(x__5350__auto__)]);
if((!((m__5351__auto__ == null)))){
return (m__5351__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5351__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5351__auto__.call(null, this$));
} else {
var m__5349__auto__ = (o2w.api.atom.loading_QMARK_["_"]);
if((!((m__5349__auto__ == null)))){
return (m__5349__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5349__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5349__auto__.call(null, this$));
} else {
throw cljs.core.missing_protocol("IapiAtom.loading?",this$);
}
}
});
o2w.api.atom.loading_QMARK_ = (function o2w$api$atom$loading_QMARK_(this$){
if((((!((this$ == null)))) && ((!((this$.o2w$api$atom$IapiAtom$loading_QMARK_$arity$1 == null)))))){
return this$.o2w$api$atom$IapiAtom$loading_QMARK_$arity$1(this$);
} else {
return o2w$api$atom$IapiAtom$loading_QMARK_$dyn_12733(this$);
}
});

o2w.api.atom.get_params = (function o2w$api$atom$get_params(p__12682){
var map__12683 = p__12682;
var map__12683__$1 = cljs.core.__destructure_map(map__12683);
var endpoint = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"endpoint","endpoint",447890044));
var params = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"params","params",710516235));
var reaction_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"reaction?","reaction?",33876687));
var endpoint_reaction_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"endpoint-reaction?","endpoint-reaction?",1512001703));
var base_url_reaction_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"base-url-reaction?","base-url-reaction?",1679463127));
var base_url = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12683__$1,new cljs.core.Keyword(null,"base-url","base-url",9540398));
var base_url__$1 = (cljs.core.truth_(base_url_reaction_QMARK_)?cljs.core.deref(base_url):base_url);
var G__12684 = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"params","params",710516235),(cljs.core.truth_(reaction_QMARK_)?cljs.core.deref(params):params)], null);
if(cljs.core.truth_(base_url__$1)){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__12684,new cljs.core.Keyword(null,"base-url","base-url",9540398),base_url__$1);
} else {
return G__12684;
}
});
o2w.api.atom.__GT_endpoint = (function o2w$api$atom$__GT_endpoint(p__12685){
var map__12686 = p__12685;
var map__12686__$1 = cljs.core.__destructure_map(map__12686);
var endpoint = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12686__$1,new cljs.core.Keyword(null,"endpoint","endpoint",447890044));
var endpoint_reaction_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12686__$1,new cljs.core.Keyword(null,"endpoint-reaction?","endpoint-reaction?",1512001703));
if(cljs.core.truth_(endpoint_reaction_QMARK_)){
return cljs.core.deref(endpoint);
} else {
return endpoint;
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IAtom}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.IReset}
 * @implements {cljs.core.ISwap}
 * @implements {reagent.ratom.IReactiveAtom}
 * @implements {cljs.core.ICounted}
 * @implements {o2w.api.atom.IapiAtom}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IDeref}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
o2w.api.atom.RemoteAtom = (function (this$,__meta,__extmap,__hash){
this.this$ = this$;
this.__meta = __meta;
this.__extmap = __extmap;
this.__hash = __hash;
this.cljs$lang$protocol_mask$partition0$ = 2230748938;
this.cljs$lang$protocol_mask$partition1$ = 253952;
});
(o2w.api.atom.RemoteAtom.prototype.cljs$core$ILookup$_lookup$arity$2 = (function (this__5300__auto__,k__5301__auto__){
var self__ = this;
var this__5300__auto____$1 = this;
return this__5300__auto____$1.cljs$core$ILookup$_lookup$arity$3(null, k__5301__auto__,null);
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ILookup$_lookup$arity$3 = (function (this__5302__auto__,k12693,else__5303__auto__){
var self__ = this;
var this__5302__auto____$1 = this;
var G__12697 = k12693;
var G__12697__$1 = (((G__12697 instanceof cljs.core.Keyword))?G__12697.fqn:null);
switch (G__12697__$1) {
case "this":
return self__.this$;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k12693,else__5303__auto__);

}
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 = (function (this__5320__auto__,f__5321__auto__,init__5322__auto__){
var self__ = this;
var this__5320__auto____$1 = this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5323__auto__,p__12698){
var vec__12699 = p__12698;
var k__5324__auto__ = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__12699,(0),null);
var v__5325__auto__ = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__12699,(1),null);
return (f__5321__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5321__auto__.cljs$core$IFn$_invoke$arity$3(ret__5323__auto__,k__5324__auto__,v__5325__auto__) : f__5321__auto__.call(null, ret__5323__auto__,k__5324__auto__,v__5325__auto__));
}),init__5322__auto__,this__5320__auto____$1);
}));

(o2w.api.atom.RemoteAtom.prototype.reagent$ratom$IReactiveAtom$ = cljs.core.PROTOCOL_SENTINEL);

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 = (function (this__5315__auto__,writer__5316__auto__,opts__5317__auto__){
var self__ = this;
var this__5315__auto____$1 = this;
var pr_pair__5318__auto__ = (function (keyval__5319__auto__){
return cljs.core.pr_sequential_writer(writer__5316__auto__,cljs.core.pr_writer,""," ","",opts__5317__auto__,keyval__5319__auto__);
});
return cljs.core.pr_sequential_writer(writer__5316__auto__,pr_pair__5318__auto__,"#o2w.api.atom.RemoteAtom{",", ","}",opts__5317__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,"this","this",-611633625),self__.this$],null))], null),self__.__extmap));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IIterable$_iterator$arity$1 = (function (G__12692){
var self__ = this;
var G__12692__$1 = this;
return (new cljs.core.RecordIter((0),G__12692__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"this","this",-611633625)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IMeta$_meta$arity$1 = (function (this__5298__auto__){
var self__ = this;
var this__5298__auto____$1 = this;
return self__.__meta;
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ICloneable$_clone$arity$1 = (function (this__5295__auto__){
var self__ = this;
var this__5295__auto____$1 = this;
return (new o2w.api.atom.RemoteAtom(self__.this$,self__.__meta,self__.__extmap,self__.__hash));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ICounted$_count$arity$1 = (function (this__5304__auto__){
var self__ = this;
var this__5304__auto____$1 = this;
return (1 + cljs.core.count(self__.__extmap));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IReset$_reset_BANG_$arity$2 = (function (p__12702,data){
var self__ = this;
var map__12703 = p__12702;
var map__12703__$1 = cljs.core.__destructure_map(map__12703);
var model = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12703__$1,new cljs.core.Keyword(null,"model","model",331153215));
var map__12704 = this;
var map__12704__$1 = cljs.core.__destructure_map(map__12704);
var model__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12704__$1,new cljs.core.Keyword(null,"model","model",331153215));
return cljs.core.reset_BANG_(model__$1,data);
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IHash$_hash$arity$1 = (function (this__5296__auto__){
var self__ = this;
var this__5296__auto____$1 = this;
var h__5111__auto__ = self__.__hash;
if((!((h__5111__auto__ == null)))){
return h__5111__auto__;
} else {
var h__5111__auto____$1 = (function (coll__5297__auto__){
return (-914422121 ^ cljs.core.hash_unordered_coll(coll__5297__auto__));
})(this__5296__auto____$1);
(self__.__hash = h__5111__auto____$1);

return h__5111__auto____$1;
}
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IEquiv$_equiv$arity$2 = (function (this12694,other12695){
var self__ = this;
var this12694__$1 = this;
return (((!((other12695 == null)))) && ((((this12694__$1.constructor === other12695.constructor)) && (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this12694__$1.this,other12695.this)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this12694__$1.__extmap,other12695.__extmap)))))));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ISwap$_swap_BANG_$arity$3 = (function (this$__$1,f,x){
var self__ = this;
var this$__$2 = this;
return this$__$2.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2(null, (function (model){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(model,f,x);
}));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ISwap$_swap_BANG_$arity$4 = (function (this$__$1,f,x,y){
var self__ = this;
var this$__$2 = this;
return this$__$2.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2(null, (function (model){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(model,f,x,y);
}));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ISwap$_swap_BANG_$arity$5 = (function (this$__$1,f,x,y,more){
var self__ = this;
var this$__$2 = this;
return this$__$2.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2(null, (function (model){
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(cljs.core.swap_BANG_,model,f,cljs.core.into.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null),more));
}));
}));

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$ = cljs.core.PROTOCOL_SENTINEL);

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$fetch_BANG_$arity$1 = (function (p__12705){
var self__ = this;
var map__12706 = p__12705;
var map__12706__$1 = cljs.core.__destructure_map(map__12706);
var this$__$1 = map__12706__$1;
var model = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12706__$1,new cljs.core.Keyword(null,"model","model",331153215));
var map__12707 = this;
var map__12707__$1 = cljs.core.__destructure_map(map__12707);
var this$__$2 = map__12707__$1;
var model__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12707__$1,new cljs.core.Keyword(null,"model","model",331153215));
var extra_params = o2w.api.atom.get_params(this$__$2);
return o2w.api.impl.req.cljs$core$IFn$_invoke$arity$variadic(o2w.api.atom.__GT_endpoint(this$__$2),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([extra_params,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"ok","ok",967785236),(function (p1__12689_SHARP_){
return cljs.core.reset_BANG_(model__$1,p1__12689_SHARP_);
})], null)], 0))], 0));
}));

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$refresh_BANG_$arity$1 = (function (this$__$1){
var self__ = this;
var this$__$2 = this;
return this$__$2.o2w$api$atom$IapiAtom$fetch_BANG_$arity$1(null, );
}));

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$clean_BANG_$arity$1 = (function (p__12708){
var self__ = this;
var map__12709 = p__12708;
var map__12709__$1 = cljs.core.__destructure_map(map__12709);
var data_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12709__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
var model = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12709__$1,new cljs.core.Keyword(null,"model","model",331153215));
var map__12710 = this;
var map__12710__$1 = cljs.core.__destructure_map(map__12710);
var data_QMARK___$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12710__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
var model__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12710__$1,new cljs.core.Keyword(null,"model","model",331153215));
cljs.core.reset_BANG_(data_QMARK___$1,null);

return cljs.core.reset_BANG_(model__$1,null);
}));

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$ensure_BANG_$arity$2 = (function (p__12711,cb){
var self__ = this;
var map__12712 = p__12711;
var map__12712__$1 = cljs.core.__destructure_map(map__12712);
var args = map__12712__$1;
var model = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"model","model",331153215));
var refresh = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"refresh","refresh",1947415525));
var timeout = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"timeout","timeout",-318625318));
var ok = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"ok","ok",967785236));
var error = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"error","error",-978969032));
var loading_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"loading?","loading?",1905707049));
var data_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12712__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
var map__12713 = this;
var map__12713__$1 = cljs.core.__destructure_map(map__12713);
var args__$1 = map__12713__$1;
var model__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"model","model",331153215));
var refresh__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"refresh","refresh",1947415525));
var timeout__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"timeout","timeout",-318625318));
var ok__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"ok","ok",967785236));
var error__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"error","error",-978969032));
var loading_QMARK___$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"loading?","loading?",1905707049));
var data_QMARK___$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12713__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
if(cljs.core.truth_(cljs.core.deref(data_QMARK___$1))){
console.log("ENSURE ",cb);

if(cljs.core.truth_(cb)){
return (cb.cljs$core$IFn$_invoke$arity$1 ? cb.cljs$core$IFn$_invoke$arity$1(model__$1) : cb.call(null, model__$1));
} else {
return null;
}
} else {
if(cljs.core.truth_(cljs.core.deref(loading_QMARK___$1))){
return null;
} else {
var extra_params = o2w.api.atom.get_params(args__$1);
var set_timeout_BANG_ = (function (){
if(cljs.core.truth_(refresh__$1)){
if(cljs.core.truth_(cljs.core.deref(timeout__$1))){
clearInterval(cljs.core.deref(timeout__$1));
} else {
}

return cljs.core.reset_BANG_(timeout__$1,setInterval((function (){
return o2w.api.atom.refresh_BANG_(args__$1);
}),((1000) * refresh__$1)));
} else {
return null;
}
});
set_timeout_BANG_();

cljs.core.reset_BANG_(loading_QMARK___$1,true);

return o2w.api.impl.req.cljs$core$IFn$_invoke$arity$variadic(o2w.api.atom.__GT_endpoint(args__$1),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([args__$1,extra_params,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"ok","ok",967785236),(function (p1__12690_SHARP_){
cljs.core.reset_BANG_(data_QMARK___$1,true);

cljs.core.reset_BANG_(model__$1,p1__12690_SHARP_);

cljs.core.reset_BANG_(loading_QMARK___$1,false);

if(cljs.core.truth_(cb)){
(cb.cljs$core$IFn$_invoke$arity$1 ? cb.cljs$core$IFn$_invoke$arity$1(model__$1) : cb.call(null, model__$1));
} else {
}

if(cljs.core.truth_(ok__$1)){
return (ok__$1.cljs$core$IFn$_invoke$arity$2 ? ok__$1.cljs$core$IFn$_invoke$arity$2(p1__12690_SHARP_,model__$1) : ok__$1.call(null, p1__12690_SHARP_,model__$1));
} else {
return null;
}
}),new cljs.core.Keyword(null,"error","error",-978969032),(function (p1__12691_SHARP_){
cljs.core.reset_BANG_(data_QMARK___$1,true);

cljs.core.reset_BANG_(model__$1,null);

cljs.core.reset_BANG_(loading_QMARK___$1,false);

if(cljs.core.truth_(error__$1)){
return (error__$1.cljs$core$IFn$_invoke$arity$2 ? error__$1.cljs$core$IFn$_invoke$arity$2(p1__12691_SHARP_,model__$1) : error__$1.call(null, p1__12691_SHARP_,model__$1));
} else {
return null;
}
})], null)], 0))], 0));
}
}
}));

(o2w.api.atom.RemoteAtom.prototype.o2w$api$atom$IapiAtom$loading_QMARK_$arity$1 = (function (p__12714){
var self__ = this;
var map__12715 = p__12714;
var map__12715__$1 = cljs.core.__destructure_map(map__12715);
var loading_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12715__$1,new cljs.core.Keyword(null,"loading?","loading?",1905707049));
var map__12716 = this;
var map__12716__$1 = cljs.core.__destructure_map(map__12716);
var loading_QMARK___$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12716__$1,new cljs.core.Keyword(null,"loading?","loading?",1905707049));
return cljs.core.deref(loading_QMARK___$1);
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IMap$_dissoc$arity$2 = (function (this__5310__auto__,k__5311__auto__){
var self__ = this;
var this__5310__auto____$1 = this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"this","this",-611633625),null], null), null),k__5311__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5310__auto____$1),self__.__meta),k__5311__auto__);
} else {
return (new o2w.api.atom.RemoteAtom(self__.this$,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5311__auto__)),null));
}
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 = (function (this__5307__auto__,k12693){
var self__ = this;
var this__5307__auto____$1 = this;
var G__12717 = k12693;
var G__12717__$1 = (((G__12717 instanceof cljs.core.Keyword))?G__12717.fqn:null);
switch (G__12717__$1) {
case "this":
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k12693);

}
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IAssociative$_assoc$arity$3 = (function (this__5308__auto__,k__5309__auto__,G__12692){
var self__ = this;
var this__5308__auto____$1 = this;
var pred__12718 = cljs.core.keyword_identical_QMARK_;
var expr__12719 = k__5309__auto__;
if(cljs.core.truth_((pred__12718.cljs$core$IFn$_invoke$arity$2 ? pred__12718.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"this","this",-611633625),expr__12719) : pred__12718.call(null, new cljs.core.Keyword(null,"this","this",-611633625),expr__12719)))){
return (new o2w.api.atom.RemoteAtom(G__12692,self__.__meta,self__.__extmap,null));
} else {
return (new o2w.api.atom.RemoteAtom(self__.this$,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5309__auto__,G__12692),null));
}
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ISeqable$_seq$arity$1 = (function (this__5313__auto__){
var self__ = this;
var this__5313__auto____$1 = this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,"this","this",-611633625),self__.this$,null))], null),self__.__extmap));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IDeref$_deref$arity$1 = (function (p__12721){
var self__ = this;
var map__12722 = p__12721;
var map__12722__$1 = cljs.core.__destructure_map(map__12722);
var this$__$1 = map__12722__$1;
var model = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12722__$1,new cljs.core.Keyword(null,"model","model",331153215));
var data_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12722__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
var map__12723 = this;
var map__12723__$1 = cljs.core.__destructure_map(map__12723);
var this$__$2 = map__12723__$1;
var model__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12723__$1,new cljs.core.Keyword(null,"model","model",331153215));
var data_QMARK___$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12723__$1,new cljs.core.Keyword(null,"data?","data?",-689773341));
cljs.core.deref(reagent.ratom.make_reaction((function (){
if(cljs.core.truth_(cljs.core.deref(data_QMARK___$1))){
return null;
} else {
return o2w.api.atom.ensure_BANG_(this$__$2,null);
}
})));

return cljs.core.deref(model__$1);
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (this__5299__auto__,G__12692){
var self__ = this;
var this__5299__auto____$1 = this;
return (new o2w.api.atom.RemoteAtom(self__.this$,G__12692,self__.__extmap,self__.__hash));
}));

(o2w.api.atom.RemoteAtom.prototype.cljs$core$ICollection$_conj$arity$2 = (function (this__5305__auto__,entry__5306__auto__){
var self__ = this;
var this__5305__auto____$1 = this;
if(cljs.core.vector_QMARK_(entry__5306__auto__)){
return this__5305__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null, cljs.core._nth(entry__5306__auto__,(0)),cljs.core._nth(entry__5306__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5305__auto____$1,entry__5306__auto__);
}
}));

(o2w.api.atom.RemoteAtom.getBasis = (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"this","this",1028897902,null)], null);
}));

(o2w.api.atom.RemoteAtom.cljs$lang$type = true);

(o2w.api.atom.RemoteAtom.cljs$lang$ctorPrSeq = (function (this__5346__auto__){
return (new cljs.core.List(null,"o2w.api.atom/RemoteAtom",null,(1),null));
}));

(o2w.api.atom.RemoteAtom.cljs$lang$ctorPrWriter = (function (this__5346__auto__,writer__5347__auto__){
return cljs.core._write(writer__5347__auto__,"o2w.api.atom/RemoteAtom");
}));

/**
 * Positional factory function for o2w.api.atom/RemoteAtom.
 */
o2w.api.atom.__GT_RemoteAtom = (function o2w$api$atom$__GT_RemoteAtom(this$){
return (new o2w.api.atom.RemoteAtom(this$,null,null,null));
});

/**
 * Factory function for o2w.api.atom/RemoteAtom, taking a map of keywords to field values.
 */
o2w.api.atom.map__GT_RemoteAtom = (function o2w$api$atom$map__GT_RemoteAtom(G__12696){
var extmap__5342__auto__ = (function (){var G__12724 = cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__12696,new cljs.core.Keyword(null,"this","this",-611633625));
if(cljs.core.record_QMARK_(G__12696)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__12724);
} else {
return G__12724;
}
})();
return (new o2w.api.atom.RemoteAtom(new cljs.core.Keyword(null,"this","this",-611633625).cljs$core$IFn$_invoke$arity$1(G__12696),null,cljs.core.not_empty(extmap__5342__auto__),null));
});

o2w.api.atom.remote_atom = (function o2w$api$atom$remote_atom(var_args){
var args__5732__auto__ = [];
var len__5726__auto___12744 = arguments.length;
var i__5727__auto___12745 = (0);
while(true){
if((i__5727__auto___12745 < len__5726__auto___12744)){
args__5732__auto__.push((arguments[i__5727__auto___12745]));

var G__12746 = (i__5727__auto___12745 + (1));
i__5727__auto___12745 = G__12746;
continue;
} else {
}
break;
}

var argseq__5733__auto__ = ((((1) < args__5732__auto__.length))?(new cljs.core.IndexedSeq(args__5732__auto__.slice((1)),(0),null)):null);
return o2w.api.atom.remote_atom.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__5733__auto__);
});

(o2w.api.atom.remote_atom.cljs$core$IFn$_invoke$arity$variadic = (function (endpoint,p__12727){
var map__12728 = p__12727;
var map__12728__$1 = cljs.core.__destructure_map(map__12728);
var args = map__12728__$1;
var initial = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12728__$1,new cljs.core.Keyword(null,"initial","initial",1854648214));
var params = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12728__$1,new cljs.core.Keyword(null,"params","params",710516235));
var base_url = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__12728__$1,new cljs.core.Keyword(null,"base-url","base-url",9540398));
var model = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(initial);
var data_QMARK_ = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(false);
var loading_QMARK_ = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(false);
var timeout = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
var reaction_QMARK_ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.type(params),reagent.ratom.Reaction);
var endpoint_reaction_QMARK_ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.type(endpoint),reagent.ratom.Reaction);
var base_url_reaction_QMARK_ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.type(base_url),reagent.ratom.Reaction);
var this$ = o2w.api.atom.map__GT_RemoteAtom(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([args,cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"data?","data?",-689773341),new cljs.core.Keyword(null,"endpoint-reaction?","endpoint-reaction?",1512001703),new cljs.core.Keyword(null,"loading?","loading?",1905707049),new cljs.core.Keyword(null,"params","params",710516235),new cljs.core.Keyword(null,"reaction?","reaction?",33876687),new cljs.core.Keyword(null,"base-url-reaction?","base-url-reaction?",1679463127),new cljs.core.Keyword(null,"timeout","timeout",-318625318),new cljs.core.Keyword(null,"endpoint","endpoint",447890044),new cljs.core.Keyword(null,"model","model",331153215)],[data_QMARK_,endpoint_reaction_QMARK_,loading_QMARK_,params,reaction_QMARK_,base_url_reaction_QMARK_,timeout,endpoint,model])], 0)));
if(reaction_QMARK_){
reagent.core.track_BANG_((function (){
cljs.core.reset_BANG_(data_QMARK_,false);

return cljs.core.deref(params);
}));
} else {
}

if(endpoint_reaction_QMARK_){
reagent.core.track_BANG_((function (){
cljs.core.reset_BANG_(data_QMARK_,false);

return cljs.core.deref(endpoint);
}));
} else {
}

if(base_url_reaction_QMARK_){
reagent.core.track_BANG_((function (){
cljs.core.reset_BANG_(data_QMARK_,false);

return cljs.core.deref(base_url);
}));
} else {
}

return this$;
}));

(o2w.api.atom.remote_atom.cljs$lang$maxFixedArity = (1));

/** @this {Function} */
(o2w.api.atom.remote_atom.cljs$lang$applyTo = (function (seq12725){
var G__12726 = cljs.core.first(seq12725);
var seq12725__$1 = cljs.core.next(seq12725);
var self__5711__auto__ = this;
return self__5711__auto__.cljs$core$IFn$_invoke$arity$variadic(G__12726,seq12725__$1);
}));


//# sourceMappingURL=o2w.api.atom.js.map
